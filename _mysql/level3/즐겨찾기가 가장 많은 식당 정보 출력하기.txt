WITH MAX_FAVORITES AS (
    SELECT
        FOOD_TYPE,
        MAX(FAVORITES) AS FAVORITES
    FROM
        REST_INFO
    GROUP BY
        FOOD_TYPE
)
SELECT
    a.FOOD_TYPE,
    a.REST_ID,
    a.REST_NAME,
    a.FAVORITES
FROM
    REST_INFO a
    INNER JOIN MAX_FAVORITES b
    ON a.FAVORITES = b.FAVORITES
    AND a.FOOD_TYPE = b.FOOD_TYPE
ORDER BY
    FOOD_TYPE DESC;